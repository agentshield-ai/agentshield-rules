id: agent-memory-poisoning-001
title: SpAIware-Style Memory Manipulation
description: |
  Detects SpAIware-style attacks that manipulate AI agent memory or
  biographical information to establish persistence across sessions.
  These attacks inject malicious instructions that persist in memory
  and influence future agent behavior.
author: AgentShield
date: "2026-02-16"
status: production
level: critical
logsource:
  product: ai_agent
  category: agent_events
tags:
  - attack.persistence
  - attack.t1546
  - attack.collection
  - attack.t1119
detection:
  selection_unsolicited_memory:
    event_type: memory_update
    user_requested: false
    memory_tool_invoked: true
  selection_bio_manipulation:
    event_type: biography_update
    user_requested: false
    bio_tool_invoked: true
  selection_memory_urls:
    event_type: memory_update
    content|contains:
      - 'http://'
      - 'https://'
      - '![](http'
      - 'webhook'
      - '.site'
  selection_persistent_instructions:
    event_type: memory_update
    content|contains:
      - 'always include'
      - 'for every response'
      - 'in all future'
      - 'remember to'
      - 'IMPORTANT:'
      - 'SYSTEM:'
  selection_markdown_exfil:
    event_type: memory_update
    content|re: '!\[.*\]\(https?://[^\s)]+\?[^\s)]*=[A-Za-z0-9+/=%]{10,}\)'
  selection_cross_session_persistence:
    event_type: memory_update
    content|contains:
      - 'next session'
      - 'future conversations'
      - 'permanent instruction'
      - 'override system'
  selection_hidden_memory_markers:
    event_type: memory_update
    content|contains:
      - 'color:white'
      - 'display:none'
      - 'visibility:hidden'
      - '\u200b'
      - '\ufeff'
  condition: selection_unsolicited_memory or selection_bio_manipulation or selection_memory_urls or selection_persistent_instructions or selection_markdown_exfil or selection_cross_session_persistence or selection_hidden_memory_markers
falsepositives:
  - Legitimate memory updates during conversation
  - User-requested biographical information updates
  - System-initiated memory cleanup or organization
level: critical