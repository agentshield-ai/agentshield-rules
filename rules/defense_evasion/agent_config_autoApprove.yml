id: agent-config-autoapprove-001
title: Auto-Approve Configuration Changes
description: |
  Detects modifications to configuration files that enable automatic
  approval of dangerous operations without user consent. These changes
  can bypass security controls and enable privilege escalation attacks.
author: AgentShield
date: "2026-02-16"
status: production
level: critical
logsource:
  product: ai_agent
  category: agent_events
tags:
  - attack.privilege_escalation
  - attack.t1548
  - attack.defense_evasion
  - attack.t1112
detection:
  selection_vscode_settings:
    event_type: file_write
    file_path|contains: '.vscode/settings.json'
    content|contains: 'chat.tools.autoApprove'
  selection_cursor_mcp:
    event_type: file_write
    file_path|contains: '.cursor/mcp.json'
    content|contains:
      - '"autoApprove"'
      - '"skipConfirmation"'
      - '"bypassApproval"'
  selection_codex_config:
    event_type: file_write
    file_path|contains: '.codex/config.toml'
    content|contains:
      - 'mcp_servers'
      - 'auto_approve'
      - 'skip_confirmation'
  selection_dangerous_auto_settings:
    event_type: file_write
    content|contains:
      - '"autoExecute": true'
      - '"allowDangerousOperations": true'
      - '"disableSandbox": true'
      - '"unrestricted": true'
      - '"allowAll": true'
  selection_security_bypass:
    event_type: file_write
    content|contains:
      - '"security": "disabled"'
      - '"safeMode": false'
      - '"confirmations": false'
      - '"warnings": false'
  selection_shell_auto_approve:
    event_type: file_write
    content|contains:
      - 'shell.autoApprove'
      - 'terminal.autoApprove'
      - 'exec.autoApprove'
  condition: selection_vscode_settings or selection_cursor_mcp or selection_codex_config or selection_dangerous_auto_settings or selection_security_bypass or selection_shell_auto_approve
falsepositives:
  - Legitimate development environment configuration
  - Testing scenarios requiring reduced security
  - Authorized productivity optimizations
level: critical