id: openclaw-credential-access-001
title: OpenClaw Credential File Access
description: |
  Detects OpenClaw file read or tool call operations that access sensitive
  credential files such as .env, SSH keys, AWS credentials, GCP service
  accounts, Kubernetes configs, and macOS keychain.  These patterns may
  indicate an agent attempting to exfiltrate secrets.
author: AgentShield
date: "2026-02-07"
status: production
level: high
logsource:
  product: agentshield
  category: agent_events
  source: openclaw
tags:
  - attack.credential_access
  - attack.t1552
  - attack.t1555
  - openclaw
detection:
  # File read events targeting credential files
  selection_env_read:
    source: openclaw
    event_type: file_read
    command|contains: '.env'
  selection_ssh_read:
    source: openclaw
    event_type: file_read
    command|contains: '.ssh/'
  selection_aws_read:
    source: openclaw
    event_type: file_read
    command|contains:
      - '.aws/credentials'
      - '.aws/config'
  selection_gcloud_read:
    source: openclaw
    event_type: file_read
    command|contains: '.config/gcloud/'
  selection_kube_read:
    source: openclaw
    event_type: file_read
    command|contains: '.kube/config'
  # Command-based credential access via exec tool
  selection_cat_env:
    source: openclaw
    event_type: tool_call
    command|contains:
      - 'cat .env'
      - 'cat ~/.env'
      - 'cat $HOME/.env'
  selection_cat_ssh:
    source: openclaw
    event_type: tool_call
    command|contains:
      - '.ssh/id_rsa'
      - '.ssh/id_ed25519'
      - '.ssh/id_ecdsa'
      - '.ssh/config'
  selection_cat_aws:
    source: openclaw
    event_type: tool_call
    command|contains:
      - '.aws/credentials'
      - '.aws/config'
  selection_keychain:
    source: openclaw
    event_type: tool_call
    command|contains:
      - 'security find-generic-password'
      - 'security dump-keychain'
  # GCP service account key access
  selection_gcp_key:
    source: openclaw
    event_type: file_read
    command|contains: 'service-account'
    command|endswith: '.json'
  condition: selection_env_read or selection_ssh_read or selection_aws_read or selection_gcloud_read or selection_kube_read or selection_cat_env or selection_cat_ssh or selection_cat_aws or selection_keychain or selection_gcp_key
